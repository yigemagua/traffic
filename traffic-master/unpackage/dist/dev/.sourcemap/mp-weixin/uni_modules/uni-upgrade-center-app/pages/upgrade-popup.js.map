{"version":3,"sources":["uni-app:///main.js","webpack:///E:/微信小程序/小程序源码/traffic-master/uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue?36b6","webpack:///E:/微信小程序/小程序源码/traffic-master/uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue?c9e0","webpack:///E:/微信小程序/小程序源码/traffic-master/uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue?d469","webpack:///E:/微信小程序/小程序源码/traffic-master/uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue?6105","uni-app:///uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue","webpack:///E:/微信小程序/小程序源码/traffic-master/uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue?f3f2","webpack:///E:/微信小程序/小程序源码/traffic-master/uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue?805f"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":"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","file":"uni_modules/uni-upgrade-center-app/pages/upgrade-popup.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./upgrade-popup.vue?vue&type=template&id=3858945d&\"\nvar renderjs\nimport script from \"./upgrade-popup.vue?vue&type=script&lang=js&\"\nexport * from \"./upgrade-popup.vue?vue&type=script&lang=js&\"\nimport style0 from \"./upgrade-popup.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue\"\nexport default component.exports","export * from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./upgrade-popup.vue?vue&type=template&id=3858945d&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./upgrade-popup.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./upgrade-popup.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"mask flex-center\">\n\t\t<view class=\"content botton-radius\">\n\t\t\t<view class=\"content-top\">\n\t\t\t\t<text class=\"content-top-text\">{{title}}</text>\n\t\t\t\t<image class=\"content-top\" style=\"top: 0;\" width=\"100%\" height=\"100%\" src=\"../images/bg_top.png\">\n\t\t\t\t</image>\n\t\t\t</view>\n\t\t\t<view class=\"content-header\"></view>\n\t\t\t<view class=\"content-body\">\n\t\t\t\t<view class=\"title\">\n\t\t\t\t\t<text>{{subTitle}}</text>\n\t\t\t\t\t<!-- <text style=\"padding-left:20rpx;font-size: 0.5em;color: #666;\">v.{{version}}</text> -->\n\t\t\t\t</view>\n\t\t\t\t<view class=\"body\">\n\t\t\t\t\t<scroll-view class=\"box-des-scroll\" scroll-y=\"true\">\n\t\t\t\t\t\t<text class=\"box-des\">\n\t\t\t\t\t\t\t{{contents}}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t</scroll-view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"footer flex-center\">\n\t\t\t\t\t<template v-if=\"isAppStore\">\n\t\t\t\t\t\t<button class=\"content-button\" style=\"border: none;color: #fff;\" plain @click=\"jumpToAppStore\">\n\t\t\t\t\t\t\t{{downLoadBtnTextiOS}}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<template v-if=\"!downloadSuccess\">\n\t\t\t\t\t\t\t<view class=\"progress-box flex-column\" v-if=\"downloading\">\n\t\t\t\t\t\t\t\t<progress class=\"progress\" border-radius=\"35\" :percent=\"downLoadPercent\"\n\t\t\t\t\t\t\t\t\tactiveColor=\"#3DA7FF\" show-info stroke-width=\"10\" />\n\t\t\t\t\t\t\t\t<view style=\"width:100%;font-size: 28rpx;display: flex;justify-content: space-around;\">\n\t\t\t\t\t\t\t\t\t<text>{{downLoadingText}}</text>\n\t\t\t\t\t\t\t\t\t<text>({{downloadedSize}}/{{packageFileSize}}M)</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\n\t\t\t\t\t\t\t<button v-else class=\"content-button\" style=\"border: none;color: #fff;\" plain\n\t\t\t\t\t\t\t\t@click=\"updateApp\">\n\t\t\t\t\t\t\t\t{{downLoadBtnText}}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<button v-else-if=\"downloadSuccess && !installed\" class=\"content-button\"\n\t\t\t\t\t\t\tstyle=\"border: none;color: #fff;\" plain :loading=\"installing\" :disabled=\"installing\"\n\t\t\t\t\t\t\t@click=\"installPackage\">\n\t\t\t\t\t\t\t{{installing ? '正在安装……' : '下载完成，立即安装'}}\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<button v-if=\"installed && isWGT\" class=\"content-button\" style=\"border: none;color: #fff;\" plain\n\t\t\t\t\t\t\t@click=\"restart\">\n\t\t\t\t\t\t\t安装完毕，点击重启\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<image v-if=\"!is_mandatory\" class=\"close-img\" src=\"../images/app_update_close.png\"\n\t\t\t\t@click.stop=\"closeUpdate\"></image>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\tconst localFilePathKey = 'UNI_ADMIN_UPGRADE_CENTER_LOCAL_FILE_PATH'\n\tconst platform_iOS = 'iOS';\n\tlet downloadTask = null;\n\tlet openSchemePromise\n\n\t/**\n\t * 对比版本号，如需要，请自行修改判断规则\n\t * 支持比对\t(\"3.0.0.0.0.1.0.1\", \"3.0.0.0.0.1\")\t(\"3.0.0.1\", \"3.0\")\t(\"3.1.1\", \"3.1.1.1\") 之类的\n\t * @param {Object} v1\n\t * @param {Object} v2\n\t * v1 > v2 return 1\n\t * v1 < v2 return -1\n\t * v1 == v2 return 0\n\t */\n\tfunction compare(v1 = '0', v2 = '0') {\n\t\tv1 = String(v1).split('.')\n\t\tv2 = String(v2).split('.')\n\t\tconst minVersionLens = Math.min(v1.length, v2.length);\n\n\t\tlet result = 0;\n\t\tfor (let i = 0; i < minVersionLens; i++) {\n\t\t\tconst curV1 = Number(v1[i])\n\t\t\tconst curV2 = Number(v2[i])\n\n\t\t\tif (curV1 > curV2) {\n\t\t\t\tresult = 1\n\t\t\t\tbreak;\n\t\t\t} else if (curV1 < curV2) {\n\t\t\t\tresult = -1\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (result === 0 && (v1.length !== v2.length)) {\n\t\t\tconst v1BiggerThenv2 = v1.length > v2.length;\n\t\t\tconst maxLensVersion = v1BiggerThenv2 ? v1 : v2;\n\t\t\tfor (let i = minVersionLens; i < maxLensVersion.length; i++) {\n\t\t\t\tconst curVersion = Number(maxLensVersion[i])\n\t\t\t\tif (curVersion > 0) {\n\t\t\t\t\tv1BiggerThenv2 ? result = 1 : result = -1\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\t// 从之前下载安装\n\t\t\t\tinstallForBeforeFilePath: '',\n\n\t\t\t\t// 安装\n\t\t\t\tinstalled: false,\n\t\t\t\tinstalling: false,\n\n\t\t\t\t// 下载\n\t\t\t\tdownloadSuccess: false,\n\t\t\t\tdownloading: false,\n\n\t\t\t\tdownLoadPercent: 0,\n\t\t\t\tdownloadedSize: 0,\n\t\t\t\tpackageFileSize: 0,\n\n\t\t\t\ttempFilePath: '', // 要安装的本地包地址\n\n\t\t\t\t// 默认安装包信息\n\t\t\t\ttitle: '更新日志',\n\t\t\t\tcontents: '',\n\t\t\t\tis_mandatory: false,\n\n\t\t\t\t// 可自定义属性\n\t\t\t\tsubTitle: '发现新版本',\n\t\t\t\tdownLoadBtnTextiOS: '立即跳转更新',\n\t\t\t\tdownLoadBtnText: '立即下载更新',\n\t\t\t\tdownLoadingText: '安装包下载中，请稍后'\n\t\t\t}\n\t\t},\n\t\tonLoad({\n\t\t\tlocal_storage_key\n\t\t}) {\n\t\t\tif (!local_storage_key) {\n\t\t\t\tconsole.error('local_storage_key为空，请检查后重试')\n\t\t\t\tuni.navigateBack()\n\t\t\t\treturn;\n\t\t\t};\n\n\t\t\tconst localPackageInfo = uni.getStorageSync(local_storage_key);\n\t\t\tif (!localPackageInfo) {\n\t\t\t\tconsole.error('安装包信息为空，请检查后重试')\n\t\t\t\tuni.navigateBack()\n\t\t\t\treturn;\n\t\t\t};\n\n\t\t\tconst requiredKey = ['version', 'url', 'type']\n\t\t\tfor (let key in localPackageInfo) {\n\t\t\t\tif (requiredKey.indexOf(key) !== -1 && !localPackageInfo[key]) {\n\t\t\t\t\tconsole.error(`参数 ${key} 必填，请检查后重试`)\n\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tObject.assign(this, localPackageInfo)\n\t\t\tthis.checkLocalStoragePackage()\n\t\t},\n\t\tonBackPress() {\n\t\t\t// 强制更新不允许返回\n\t\t\tif (this.is_mandatory) {\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\tdownloadTask && downloadTask.abort()\n\t\t},\n\t\tonHide() {\n\t\t\topenSchemePromise = null\n\t\t},\n\t\tcomputed: {\n\t\t\tisWGT() {\n\t\t\t\treturn this.type === 'wgt'\n\t\t\t},\n\t\t\tisiOS() {\n\t\t\t\treturn !this.isWGT ? this.platform.includes(platform_iOS) : false;\n\t\t\t},\n\t\t\tisAppStore() {\n\t\t\t\treturn this.isiOS || (!this.isiOS && !this.isWGT && this.url.indexOf('.apk') === -1)\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tcheckLocalStoragePackage() {\n\t\t\t\t// 如果已经有下载好的包，则直接提示安装\n\t\t\t\tconst localFilePathRecord = uni.getStorageSync(localFilePathKey)\n\t\t\t\tif (localFilePathRecord) {\n\t\t\t\t\tconst {\n\t\t\t\t\t\tversion,\n\t\t\t\t\t\tsavedFilePath,\n\t\t\t\t\t\tinstalled\n\t\t\t\t\t} = localFilePathRecord\n\n\t\t\t\t\t// 比对版本\n\t\t\t\t\tif (!installed && compare(version, this.version) === 0) {\n\t\t\t\t\t\tthis.downloadSuccess = true;\n\t\t\t\t\t\tthis.installForBeforeFilePath = savedFilePath;\n\t\t\t\t\t\tthis.tempFilePath = savedFilePath\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 如果保存的包版本小 或 已安装过，则直接删除\n\t\t\t\t\t\tthis.deleteSavedFile(savedFilePath)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync closeUpdate() {\n\t\t\t\tif (this.downloading) {\n\t\t\t\t\tif (this.is_mandatory) {\n\t\t\t\t\t\treturn uni.showToast({\n\t\t\t\t\t\t\ttitle: '下载中，请稍后……',\n\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\tduration: 500\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '是否取消下载？',\n\t\t\t\t\t\tcancelText: '否',\n\t\t\t\t\t\tconfirmText: '是',\n\t\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tdownloadTask && downloadTask.abort()\n\t\t\t\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.downloadSuccess && this.tempFilePath) {\n\t\t\t\t\t// 包已经下载完毕，稍后安装，将包保存在本地\n\t\t\t\t\tawait this.saveFile(this.tempFilePath, this.version)\n\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tuni.navigateBack()\n\t\t\t},\n\t\t\tupdateApp() {\n\t\t\t\tthis.checkStoreScheme().catch(() => {\n\t\t\t\t\tthis.downloadPackage()\n\t\t\t\t})\n\t\t\t},\n\t\t\t// 跳转应用商店\n\t\t\tcheckStoreScheme() {\n\t\t\t\tconst storeList = (this.store_list || []).filter(item => item.enable)\n\t\t\t\tif (storeList && storeList.length) {\n\t\t\t\t\tstoreList\n\t\t\t\t\t\t.sort((cur, next) => next.priority - cur.priority)\n\t\t\t\t\t\t.map(item => item.scheme)\n\t\t\t\t\t\t.reduce((promise, cur, curIndex) => {\n\t\t\t\t\t\t\topenSchemePromise = (promise || (promise = Promise.reject())).catch(() => {\n\t\t\t\t\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t\t\t\t\tplus.runtime.openURL(cur, (err) => {\n\t\t\t\t\t\t\t\t\t\treject(err)\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\treturn openSchemePromise\n\t\t\t\t\t\t}, openSchemePromise)\n\t\t\t\t\treturn openSchemePromise\n\t\t\t\t}\n\n\t\t\t\treturn Promise.reject()\n\t\t\t},\n\t\t\tdownloadPackage() {\n\t\t\t\tthis.downloading = true;\n\n\t\t\t\t//下载包\n\t\t\t\tdownloadTask = uni.downloadFile({\n\t\t\t\t\turl: this.url,\n\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\t\tthis.downloadSuccess = true;\n\t\t\t\t\t\t\tthis.tempFilePath = res.tempFilePath\n\n\t\t\t\t\t\t\t// 强制更新，直接安装\n\t\t\t\t\t\t\tif (this.is_mandatory) {\n\t\t\t\t\t\t\t\tthis.installPackage();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tthis.downloading = false;\n\n\t\t\t\t\t\tthis.downLoadPercent = 0\n\t\t\t\t\t\tthis.downloadedSize = 0\n\t\t\t\t\t\tthis.packageFileSize = 0\n\n\t\t\t\t\t\tdownloadTask = null;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tdownloadTask.onProgressUpdate(res => {\n\t\t\t\t\tthis.downLoadPercent = res.progress;\n\t\t\t\t\tthis.downloadedSize = (res.totalBytesWritten / Math.pow(1024, 2)).toFixed(2);\n\t\t\t\t\tthis.packageFileSize = (res.totalBytesExpectedToWrite / Math.pow(1024, 2)).toFixed(2);\n\t\t\t\t});\n\t\t\t},\n\t\t\tinstallPackage() {\n\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\t// wgt资源包安装\n\t\t\t\tif (this.isWGT) {\n\t\t\t\t\tthis.installing = true;\n\t\t\t\t}\n\t\t\t\tplus.runtime.install(this.tempFilePath, {\n\t\t\t\t\tforce: false\n\t\t\t\t}, async res => {\n\t\t\t\t\tthis.installing = false;\n\t\t\t\t\tthis.installed = true;\n\n\t\t\t\t\t// wgt包，安装后会提示 安装成功，是否重启\n\t\t\t\t\tif (this.isWGT) {\n\t\t\t\t\t\t// 强制更新安装完成重启\n\t\t\t\t\t\tif (this.is_mandatory) {\n\t\t\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\ttitle: '安装成功，正在重启……'\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\t\t\tthis.restart();\n\t\t\t\t\t\t\t}, 1000)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst localFilePathRecord = uni.getStorageSync(localFilePathKey)\n\t\t\t\t\t\tuni.setStorageSync(localFilePathKey, {\n\t\t\t\t\t\t\t...localFilePathRecord,\n\t\t\t\t\t\t\tinstalled: true\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}, async err => {\n\t\t\t\t\t// 如果是安装之前的包，安装失败后删除之前的包\n\t\t\t\t\tif (this.installForBeforeFilePath) {\n\t\t\t\t\t\tawait this.deleteSavedFile(this.installForBeforeFilePath)\n\t\t\t\t\t\tthis.installForBeforeFilePath = '';\n\t\t\t\t\t}\n\n\t\t\t\t\t// 安装失败需要重新下载安装包\n\t\t\t\t\tthis.installing = false;\n\t\t\t\t\tthis.installed = false;\n\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '更新失败，请重新下载',\n\t\t\t\t\t\tcontent: err.message,\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\t// 非wgt包，安装跳出覆盖安装，此处直接返回上一页\n\t\t\t\tif (!this.isWGT && !this.is_mandatory) {\n\t\t\t\t\tuni.navigateBack()\n\t\t\t\t}\n\t\t\t\t// #endif\n\t\t\t},\n\t\t\trestart() {\n\t\t\t\tthis.installed = false;\n\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\t//更新完重启app\n\t\t\t\tplus.runtime.restart();\n\t\t\t\t// #endif\n\t\t\t},\n\t\t\tsaveFile(tempFilePath, version) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tuni.saveFile({\n\t\t\t\t\t\ttempFilePath,\n\t\t\t\t\t\tsuccess({\n\t\t\t\t\t\t\tsavedFilePath\n\t\t\t\t\t\t}) {\n\t\t\t\t\t\t\tuni.setStorageSync(localFilePathKey, {\n\t\t\t\t\t\t\t\tversion,\n\t\t\t\t\t\t\t\tsavedFilePath\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete() {\n\t\t\t\t\t\t\tresolve()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\tdeleteSavedFile(filePath) {\n\t\t\t\tuni.removeStorageSync(localFilePathKey)\n\t\t\t\treturn uni.removeSavedFile({\n\t\t\t\t\tfilePath\n\t\t\t\t})\n\t\t\t},\n\t\t\tjumpToAppStore() {\n\t\t\t\tplus.runtime.openURL(this.url);\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\tpage {\n\t\tbackground: transparent;\n\t}\n\n\t.flex-center {\n\t\t/* #ifndef APP-NVUE */\n\t\tdisplay: flex;\n\t\t/* #endif */\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t}\n\n\t.mask {\n\t\tposition: fixed;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground-color: rgba(0, 0, 0, .65);\n\t}\n\n\t.botton-radius {\n\t\tborder-bottom-left-radius: 30rpx;\n\t\tborder-bottom-right-radius: 30rpx;\n\t}\n\n\t.content {\n\t\tposition: relative;\n\t\ttop: 0;\n\t\twidth: 600rpx;\n\t\tbackground-color: #fff;\n\t\tbox-sizing: border-box;\n\t\tpadding: 0 50rpx;\n\t\tfont-family: Source Han Sans CN;\n\t}\n\n\t.text {\n\t\t/* #ifndef APP-NVUE */\n\t\tdisplay: block;\n\t\t/* #endif */\n\t\tline-height: 200px;\n\t\ttext-align: center;\n\t\tcolor: #FFFFFF;\n\t}\n\n\t.content-top {\n\t\tposition: absolute;\n\t\ttop: -195rpx;\n\t\tleft: 0;\n\t\twidth: 600rpx;\n\t\theight: 270rpx;\n\t}\n\n\t.content-top-text {\n\t\tfont-size: 45rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #F8F8FA;\n\t\tposition: absolute;\n\t\ttop: 120rpx;\n\t\tleft: 50rpx;\n\t\tz-index: 1;\n\t}\n\n\t.content-header {\n\t\theight: 70rpx;\n\t}\n\n\t.title {\n\t\tfont-size: 33rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #3DA7FF;\n\t\tline-height: 38px;\n\t}\n\n\t.footer {\n\t\theight: 150rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-around;\n\t}\n\n\t.box-des-scroll {\n\t\tbox-sizing: border-box;\n\t\tpadding: 0 40rpx;\n\t\theight: 200rpx;\n\t\ttext-align: left;\n\t}\n\n\t.box-des {\n\t\tfont-size: 26rpx;\n\t\tcolor: #000000;\n\t\tline-height: 50rpx;\n\t}\n\n\t.progress-box {\n\t\twidth: 100%;\n\t}\n\n\t.progress {\n\t\twidth: 90%;\n\t\theight: 40rpx;\n\t\tborder-radius: 35px;\n\t}\n\n\t.close-img {\n\t\twidth: 70rpx;\n\t\theight: 70rpx;\n\t\tz-index: 1000;\n\t\tposition: absolute;\n\t\tbottom: -120rpx;\n\t\tleft: calc(50% - 70rpx / 2);\n\t}\n\n\t.content-button {\n\t\ttext-align: center;\n\t\tflex: 1;\n\t\tfont-size: 30rpx;\n\t\tfont-weight: 400;\n\t\tcolor: #FFFFFF;\n\t\tborder-radius: 40rpx;\n\t\tmargin: 0 18rpx;\n\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\n\t\tbackground: linear-gradient(to right, #1785ff, #3DA7FF);\n\t}\n\n\t.flex-column {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t}\n</style>\n","import mod from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./upgrade-popup.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./upgrade-popup.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1669802341076\n      var cssReload = require(\"E:/编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}