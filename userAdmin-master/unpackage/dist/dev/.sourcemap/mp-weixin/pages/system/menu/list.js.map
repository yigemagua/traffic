{"version":3,"sources":["uni-app:///main.js","webpack:///E:/微信小程序/小程序源码/userAdmin-master/pages/system/menu/list.vue?4a60","webpack:///E:/微信小程序/小程序源码/userAdmin-master/pages/system/menu/list.vue?8594","webpack:///E:/微信小程序/小程序源码/userAdmin-master/pages/system/menu/list.vue?daf0","webpack:///E:/微信小程序/小程序源码/userAdmin-master/pages/system/menu/list.vue?06cb","uni-app:///pages/system/menu/list.vue","webpack:///E:/微信小程序/小程序源码/userAdmin-master/pages/system/menu/list.vue?6f82","webpack:///E:/微信小程序/小程序源码/userAdmin-master/pages/system/menu/list.vue?1594"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":";;;;;;;;;;kDAAA;;AAE2D;AAC3D;AACA,iG,8FAHA;AACAA,EAAE,CAACC,iCAAH,GAAuCC,mBAAvC,CAGAC,UAAU,CAACC,aAAD,CAAV,C;;;;;;;;;;;;;ACLA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiH;AACjH;AACwD;AACL;AACa;;;AAGhE;AACsM;AACtM,gBAAgB,sMAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,+EAAM;AACR,EAAE,wFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,gTAEN;AACP,KAAK;AACL;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,aAAa,+TAEN;AACP,KAAK;AACL;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,aAAa,8OAEN;AACP,KAAK;AACL;AACA,aAAa,8OAEN;AACP,KAAK;AACL;AACA,aAAa,8OAEN;AACP,KAAK;AACL;AACA,aAAa,oMAEN;AACP;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjJA;AAAA;AAAA;AAAA;AAAgxB,CAAgB,2uBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC+GpyB,sF;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAKA;AACA;AACA;AACA;AACA;AACA,KAHA;AAIA,GANA;;AAQA;;AAKA;AACA;AACA;AACA;AACA;AACA,KAHA;AAIA,GANA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAJA;AAKA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KALA;AAMA;AACA;AACA,C;;AAEA;AACA,MADA,kBACA;AACA;AACA,eADA;AAEA,eAFA;AAGA,wBAHA;AAIA;AACA,0BADA;AAEA,gCAFA,EAJA;;AAQA,wBARA,EAQA;AACA,mBATA;AAUA,eAVA;AAWA,gBAXA;AAYA,yBAZA;AAaA,kCAbA;;AAeA,GAjBA;AAkBA;AACA,eADA,yBACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OALA;AAMA;AACA,KAjBA,EAlBA;;AAqCA;AACA,eADA,uBACA,GADA,EACA;AACA;AACA;AACA;AACA,KALA,EArCA;;AA4CA;AACA,eADA,uBACA,QADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA,OAJA;AAKA;AACA,KATA;AAUA,eAVA,uBAUA,IAVA,EAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAXA,CAWA;AACA,KAtBA;AAuBA,WAvBA,mBAuBA,IAvBA,EAuBA,SAvBA,EAuBA;AACA;AACA;AACA;AACA;AACA;AACA,OALA;AAMA;AACA,KA/BA;AAgCA,aAhCA,qBAgCA,GAhCA,EAgCA;AACA;AACA,KAlCA;AAmCA,YAnCA,sBAmCA;AACA;AACA,oBADA;;AAGA,KAvCA;AAwCA,cAxCA,sBAwCA,GAxCA,EAwCA,KAxCA,EAwCA;AACA;AACA,gBADA;AAEA;AACA;AACA;AACA,WAHA,EAFA;;;AAQA,KAjDA;AAkDA,iBAlDA,yBAkDA,IAlDA,EAkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBADA;AAEA,wBAFA;AAGA;AACA;AACA;AACA;AACA;AACA,8BADA;;AAGA,SAVA;;AAYA,KArEA;AAsEA,0BAtEA,kCAsEA,CAtEA,EAsEA;AACA;AACA,KAxEA;AAyEA,kBAzEA,0BAyEA,cAzEA,EAyEA;AACA;AACA;AACA,qBADA;AAEA,+BAFA;AAGA,2BAHA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OARA;AASA;AACA,mBADA;AAEA,iCAFA;AAGA;AACA;AACA;AACA;AACA;AACA,sBADA;;AAGA;AACA;AACA;AACA;AACA,yBADA;AAEA,gCAFA;AAGA,+BAHA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA,eAVA;;AAYA,WAdA,EAcA,KAdA,CAcA;AACA;AACA,yBADA;AAEA,kCAFA;AAGA,+BAHA;;AAKA,WApBA,EAoBA,OApBA,CAoBA;AACA;AACA,WAtBA;AAuBA,SAlCA;;AAoCA,KAhIA,EA5CA,E;;;;;;;;;;;;;AC3MA;AAAA;AAAA;AAAA;AAAymC,CAAgB,khCAAG,EAAC,C;;;;;;;;;;;ACA7nC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/system/menu/list.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/system/menu/list.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./list.vue?vue&type=template&id=5890e632&\"\nvar renderjs\nimport script from \"./list.vue?vue&type=script&lang=js&\"\nexport * from \"./list.vue?vue&type=script&lang=js&\"\nimport style0 from \"./list.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/system/menu/list.vue\"\nexport default component.exports","export * from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=template&id=5890e632&\"","var components\ntry {\n  components = {\n    uniStatBreadcrumb: function() {\n      return import(\n        /* webpackChunkName: \"components/uni-stat-breadcrumb/uni-stat-breadcrumb\" */ \"@/components/uni-stat-breadcrumb/uni-stat-breadcrumb.vue\"\n      )\n    },\n    uniBadge: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-badge/components/uni-badge/uni-badge\" */ \"@/uni_modules/uni-badge/components/uni-badge/uni-badge.vue\"\n      )\n    },\n    unicloudDb: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/@dcloudio/uni-cli-shared/components/unicloud-db\" */ \"@dcloudio/uni-cli-shared/components/unicloud-db.vue\"\n      )\n    },\n    uniTable: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-table/components/uni-table/uni-table\" */ \"@/uni_modules/uni-table/components/uni-table/uni-table.vue\"\n      )\n    },\n    uniTr: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-table/components/uni-tr/uni-tr\" */ \"@/uni_modules/uni-table/components/uni-tr/uni-tr.vue\"\n      )\n    },\n    uniTh: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-table/components/uni-th/uni-th\" */ \"@/uni_modules/uni-table/components/uni-th/uni-th.vue\"\n      )\n    },\n    uniTd: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-table/components/uni-td/uni-td\" */ \"@/uni_modules/uni-table/components/uni-td/uni-td.vue\"\n      )\n    },\n    fixWindow: function() {\n      return import(\n        /* webpackChunkName: \"components/fix-window/fix-window\" */ \"@/components/fix-window/fix-window.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = _vm.$t(\"menu.text.menuManager\")\n  var m1 = _vm.pluginMenus.length ? _vm.$t(\"menu.text.additiveMenu\") : null\n  var m2 = _vm.$t(\"menu.button.addFirstLevelMenu\")\n  var m3 = _vm.$hasScopedSlotsParams(\"b98ade02-3\")\n  var m4 = m3\n    ? _vm.$getScopedSlotsParams(\"b98ade02-3\", \"default\", \"loading\")\n    : null\n  var m5 = m3 ? _vm.errMsg || _vm.$t(\"common.empty\") : null\n  var m6 = _vm.$t(\"common.button.edit\")\n  var l0 = m3\n    ? _vm.__map(\n        _vm.$getScopedSlotsParams(\"b98ade02-3\", \"default\", \"data\"),\n        function(item, index) {\n          var $orig = _vm.__get_orig(item)\n\n          var m7 =\n            item.menu_id !== \"system_menu\" &&\n            item.menu_id !== \"system_management\"\n              ? _vm.$t(\"common.button.delete\")\n              : null\n          var m8 = !item.url ? _vm.$t(\"menu.button.addChildMenu\") : null\n          return {\n            $orig: $orig,\n            m7: m7,\n            m8: m8\n          }\n        }\n      )\n    : null\n\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event, item) {\n      var _temp = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp2 = _temp.eventParams || _temp[\"event-params\"],\n        item = _temp2.item\n\n      var _temp, _temp2\n\n      return _vm.navigateTo(\"./edit?id=\" + item._id, false)\n    }\n\n    _vm.e1 = function($event, item) {\n      var _temp3 = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp4 = _temp3.eventParams || _temp3[\"event-params\"],\n        item = _temp4.item\n\n      var _temp3, _temp4\n\n      return _vm.confirmDelete(item)\n    }\n\n    _vm.e2 = function($event, item) {\n      var _temp5 = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp6 = _temp5.eventParams || _temp5[\"event-params\"],\n        item = _temp6.item\n\n      var _temp5, _temp6\n\n      return _vm.navigateTo(\"./add?parent_id=\" + item.menu_id, false)\n    }\n  }\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n        m1: m1,\n        m2: m2,\n        m3: m3,\n        m4: m4,\n        m5: m5,\n        m6: m6,\n        l0: l0\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\n\t\t<view class=\"uni-header\">\n\t\t\t<uni-stat-breadcrumb class=\"uni-stat-breadcrumb-on-phone\"/>\n\t\t</view>\n\t\t<view class=\"uni-tabs__header\">\n\t\t\t<view class=\"uni-tabs__nav-wrap\">\n\t\t\t\t<view class=\"uni-tabs__nav-scroll\">\n\t\t\t\t\t<view class=\"uni-tabs__nav\">\n\t\t\t\t\t\t<view @click=\"switchTab('menus')\" :class=\"{'is-active':currentTab==='menus'}\"\n\t\t\t\t\t\t\t  class=\"uni-tabs__item\">\n\t\t\t\t\t\t\t{{ $t('menu.text.menuManager') }}\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view @click=\"switchTab('pluginMenus')\" v-if=\"pluginMenus.length\"\n\t\t\t\t\t\t  :class=\"{'is-active':currentTab==='pluginMenus'}\" class=\"uni-tabs__item\">\n\t\t\t\t\t\t\t{{ $t('menu.text.additiveMenu') }}\n\t\t\t\t\t\t\t<uni-badge class=\"menu-badge\" :text=\"pluginMenus.length\" type=\"error\"></uni-badge>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<view v-show=\"currentTab==='menus'\">\n\t\t\t<view class=\"uni-header\" style=\"border-bottom: 0;margin-bottom: -15px;\">\n\t\t\t\t<view class=\"uni-group\">\n\t\t\t\t\t<button @click=\"navigateTo('./add')\" size=\"mini\" plain=\"true\"\n\t\t\t\t\t\t\ttype=\"primary\">{{ $t('menu.button.addFirstLevelMenu') }}\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"uni-group\">\n\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view class=\"uni-container\">\n\t\t\t\t<unicloud-db ref=\"udb\" @load=\"onqueryload\" collection=\"opendb-admin-menus\" :options=\"options\"\n\t\t\t\t\t\t\t :where=\"where\" page-data=\"replace\" :orderby=\"orderby\" :getcount=\"true\"\n\t\t\t\t\t\t\t :page-size=\"options.pageSize\"\n\t\t\t\t\t\t\t :page-current=\"options.pageCurrent\" v-slot:default=\"{data,pagination,loading,error}\">\n\t\t\t\t\t<uni-table :loading=\"loading\" class=\"table-pc\" :emptyText=\"errMsg || $t('common.empty')\" border\n\t\t\t\t\t\t\t   stripe>\n\t\t\t\t\t\t<uni-tr>\n\t\t\t\t\t\t\t<uni-th align=\"center\">排序</uni-th>\n\t\t\t\t\t\t\t<uni-th width=\"200\" align=\"center\">名称</uni-th>\n\t\t\t\t\t\t\t<uni-th align=\"center\">标识</uni-th>\n\t\t\t\t\t\t\t<uni-th align=\"center\">URL</uni-th>\n\t\t\t\t\t\t\t<uni-th width=\"100\" align=\"center\">是否启用</uni-th>\n\t\t\t\t\t\t\t<uni-th align=\"center\">操作</uni-th>\n\t\t\t\t\t\t</uni-tr>\n\t\t\t\t\t\t<uni-tr v-for=\"(item,index) in data\" :key=\"index\">\n\t\t\t\t\t\t\t<uni-td align=\"center\">{{ item.sort }}</uni-td>\n\t\t\t\t\t\t\t<uni-td>{{ item.name }}</uni-td>\n\t\t\t\t\t\t\t<uni-td>{{ item.menu_id }}</uni-td>\n\t\t\t\t\t\t\t<uni-td>{{ item.url }}</uni-td>\n\t\t\t\t\t\t\t<uni-td align=\"center\" :class=\"{'menu-disable':!item.enable}\">\n\t\t\t\t\t\t\t\t{{ item.enable ? '已启用' : '未启用' }}\n\t\t\t\t\t\t\t</uni-td>\n\t\t\t\t\t\t\t<uni-td align=\"center\">\n\t\t\t\t\t\t\t\t<view class=\"uni-group\" style=\"justify-content: left;\">\n\t\t\t\t\t\t\t\t\t<button @click=\"navigateTo('./edit?id='+item._id, false)\" class=\"uni-button\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"mini\" type=\"primary\">{{ $t('common.button.edit') }}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tv-if=\"item.menu_id !== 'system_menu' && item.menu_id !== 'system_management'\"\n\t\t\t\t\t\t\t\t\t\t@click=\"confirmDelete(item)\" class=\"uni-button\" size=\"mini\"\n\t\t\t\t\t\t\t\t\t\ttype=\"warn\">{{ $t('common.button.delete') }}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<button v-if=\"!item.url\" @click=\"navigateTo('./add?parent_id='+item.menu_id, false)\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"uni-button\" size=\"mini\"\n\t\t\t\t\t\t\t\t\t\t\ttype=\"primary\">{{ $t('menu.button.addChildMenu') }}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</uni-td>\n\t\t\t\t\t\t</uni-tr>\n\t\t\t\t\t</uni-table>\n\t\t\t\t</unicloud-db>\n\t\t\t</view>\n\t\t</view>\n\t\t<view v-show=\"currentTab==='pluginMenus'\">\n\t\t\t<view class=\"uni-header\" style=\"border-bottom: 0;margin-bottom: -15px;\">\n\t\t\t\t<view class=\"uni-group\">\n\t\t\t\t\t<button style=\"width: 130px;\" @click=\"addPluginMenus\" size=\"mini\" type=\"primary\">添加选中的菜单\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"uni-group\"></view>\n\t\t\t</view>\n\t\t\t<view class=\"uni-container\">\n\t\t\t\t<uni-table ref=\"pluginMenusTable\" type=\"selection\" border stripe\n\t\t\t\t\t\t   @selection-change=\"pluginMenuSelectChange\">\n\t\t\t\t\t<uni-tr>\n\t\t\t\t\t\t<uni-th align=\"center\">名称（标识）</uni-th>\n\t\t\t\t\t\t<uni-th align=\"center\">URL</uni-th>\n\t\t\t\t\t\t<uni-th align=\"center\">插件菜单 json 文件</uni-th>\n\t\t\t\t\t</uni-tr>\n\t\t\t\t\t<uni-tr v-for=\"(item,index) in pluginMenus\" :key=\"index\">\n\t\t\t\t\t\t<uni-td>{{ item.name }}（{{ item.menu_id }}）</uni-td>\n\t\t\t\t\t\t<uni-td>{{ item.url }}</uni-td>\n\t\t\t\t\t\t<uni-td>{{ item.json }}</uni-td>\n\t\t\t\t\t</uni-tr>\n\t\t\t\t</uni-table>\n\t\t\t\t<view class=\"uni-sub-title\" style=\"margin-top: 15px;\">\n\t\t\t\t\t以上待添加菜单来自于三方插件，添加后，将显示在菜单管理中，若不希望显示在上述表格中时，可手动删除项目中对应的`插件id-menu.json`文件。\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<!-- #ifndef H5 -->\n\t\t<fix-window/>\n\t\t<!-- #endif -->\n\t</view>\n</template>\n\n<script>\nimport {\n\tbuildMenus\n} from '../../../components/uni-data-menu/util.js'\n\nconst db = uniCloud.database()\n// 表查询配置\nconst dbOrderBy = 'create_date asc'\n// 分页配置\nconst pageSize = 20000\nconst pageCurrent = 1\n// 查找插件注册的菜单列表（目前仅在开发模式启用，仅限 admin 角色）\nconst pluginMenuJsons = []\n\nif (process.env.NODE_ENV === 'development') {\n\t// #ifdef VUE2\n\tconst rootModules = require.context(\n\t\t'../../../',\n\t\tfalse,\n\t\t/-menu.json$/\n\t)\n\trootModules.keys().forEach(function (key) {\n\t\tconst json = key.substr(2)\n\t\trootModules(key).forEach(item => {\n\t\t\titem.json = json\n\t\t\tpluginMenuJsons.push(item)\n\t\t})\n\t})\n\n\tconst pluginModules = require.context(\n\t\t'../../../uni_modules/',\n\t\ttrue,\n\t\t/menu.json$/\n\t)\n\tpluginModules.keys().forEach(function (key) {\n\t\tconst json = 'uni_modules' + key.substr(1)\n\t\tpluginModules(key).forEach(item => {\n\t\t\titem.json = json\n\t\t\tpluginMenuJsons.push(item)\n\t\t})\n\t})\n\t// #endif\n\t// #ifdef VUE3\n\tconst rootModules = import.meta.glob('../../../*-menu.json', {eager: true})\n\tfor (const modulePath in rootModules) {\n\t\tconst json = modulePath.replace(/^..\\/..\\/..\\//, '')\n\t\trootModules[modulePath]().then(module => {\n\t\t\tmodule = module.default ? module.default : module\n\t\t\tmodule.forEach(item => {\n\t\t\t\titem.json = json\n\t\t\t\tpluginMenuJsons.push(item)\n\t\t\t})\n\t\t})\n\t}\n\n\tconst pluginModules = import.meta.glob('../../../uni_modules/**/menu.json', {eager: true})\n\tfor (const modulePath in pluginModules) {\n\t\tconst json = modulePath.replace(/^..\\/..\\/..\\//, '')\n\t\tpluginModules[modulePath]().then(module => {\n\t\t\tmodule = module.default ? module.default : module\n\t\t\tmodule.forEach(item => {\n\t\t\t\titem.json = json\n\t\t\t\tpluginMenuJsons.push(item)\n\t\t\t})\n\t\t})\n\t}\n\t// #endif\n}\n\n\n// 获取父的个数\nfunction getParents(menus, id, depth = 0) {\n\tmenus.forEach(menu => {\n\t\tif (menu.menu_id === id && menu.parent_id) {\n\t\t\tdepth = depth + 1 + getParents(menus, menu.parent_id, depth)\n\t\t}\n\t})\n\treturn depth\n}\n\n// 获取子的 _id\nfunction getChildren(menus, id, childrenIds = []) {\n\tif (menus.find(menu => menu.parent_id === id)) {\n\t\tmenus.forEach(item => {\n\t\t\tif (item.parent_id === id) {\n\t\t\t\tchildrenIds.push(item._id)\n\t\t\t\tgetChildren(menus, item.menu_id, childrenIds)\n\t\t\t}\n\t\t})\n\t}\n\treturn childrenIds\n}\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tquery: '',\n\t\t\twhere: '',\n\t\t\torderby: dbOrderBy,\n\t\t\toptions: {\n\t\t\t\tpageSize,\n\t\t\t\tpageCurrent\n\t\t\t},\n\t\t\tselectedIndexs: [], //批量选中的项\n\t\t\tloading: true,\n\t\t\tmenus: [],\n\t\t\terrMsg: '',\n\t\t\tcurrentTab: 'menus',\n\t\t\tselectedPluginMenuIndexs: []\n\t\t}\n\t},\n\tcomputed: {\n\t\tpluginMenus() {\n\t\t\tconst menus = []\n\t\t\tif (!this.$hasRole('admin')) {\n\t\t\t\treturn menus\n\t\t\t}\n\t\t\tconst dbMenus = this.menus\n\t\t\tif (!dbMenus.length) {\n\t\t\t\treturn menus\n\t\t\t}\n\t\t\tpluginMenuJsons.forEach(menu => {\n\t\t\t\t// 查找尚未被注册到数据库中的菜单\n\t\t\t\tif (!dbMenus.find(item => item.menu_id === menu.menu_id)) {\n\t\t\t\t\tmenus.push(menu)\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn menus\n\t\t},\n\t},\n\twatch: {\n\t\tpluginMenus(val) {\n\t\t\tif (!val.length) {\n\t\t\t\tthis.currentTab = 'menus'\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\tgetSortMenu(menuList) {\n\t\t\t// 标记叶子节点\n\t\t\tmenuList.map(item => {\n\t\t\t\tif (!menuList.some(subMenuItem => subMenuItem.parent_id === item.menu_id)) {\n\t\t\t\t\titem.isLeafNode = true\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn buildMenus(menuList)\n\t\t},\n\t\tonqueryload(data) {\n\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\tlet item = data[i]\n\t\t\t\tconst depth = getParents(data, item.menu_id)\n\t\t\t\titem.name = (depth ? '　'.repeat(depth) + '|-' : '') + item.name\n\t\t\t}\n\t\t\tconst menuTree = this.getSortMenu(data)\n\t\t\tconst sortMenus = []\n\t\t\tthis.patTree(menuTree, sortMenus)\n\t\t\tdata.length = 0;\n\t\t\tdata.push(...sortMenus)\n\t\t\tthis.menus = data //仅导出当前页\n\t\t},\n\t\tpatTree(tree, sortMenus) {\n\t\t\ttree.forEach(item => {\n\t\t\t\tsortMenus.push(item)\n\t\t\t\tif (item.children.length) {\n\t\t\t\t\tthis.patTree(item.children, sortMenus)\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn sortMenus\n\t\t},\n\t\tswitchTab(tab) {\n\t\t\tthis.currentTab = tab\n\t\t},\n\t\tloadData(clear = true) {\n\t\t\tthis.$refs.udb.loadData({\n\t\t\t\tclear\n\t\t\t})\n\t\t},\n\t\tnavigateTo(url, clear) { // clear 表示刷新列表时是否清除当前页码，true 表示刷新并回到列表第 1 页，默认为 true\n\t\t\tuni.navigateTo({\n\t\t\t\turl,\n\t\t\t\tevents: {\n\t\t\t\t\trefreshData: () => {\n\t\t\t\t\t\tthis.loadData(clear)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tconfirmDelete(menu) {\n\t\t\tlet ids = menu._id\n\t\t\tlet content = '是否删除该菜单？'\n\t\t\t// 如有子菜单\n\t\t\tconst children = getChildren(this.menus, menu.menu_id)\n\t\t\tif (children.length) content = '是否删除该菜单及其子菜单？'\n\t\t\tids = [ids, ...children]\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '提示',\n\t\t\t\tcontent,\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (!res.confirm) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tthis.$refs.udb.remove(ids, {\n\t\t\t\t\t\tneedConfirm: false\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tpluginMenuSelectChange(e) {\n\t\t\tthis.selectedPluginMenuIndexs = e.detail.index\n\t\t},\n\t\taddPluginMenus(confirmContent) {\n\t\t\tif (!this.selectedPluginMenuIndexs.length) {\n\t\t\t\treturn uni.showModal({\n\t\t\t\t\ttitle: '提示',\n\t\t\t\t\tcontent: '请选择要添加的菜单！',\n\t\t\t\t\tshowCancel: false\n\t\t\t\t})\n\t\t\t}\n\t\t\tconst pluginMenus = this.pluginMenus\n\t\t\tconst menus = []\n\t\t\tthis.selectedPluginMenuIndexs.forEach(i => {\n\t\t\t\tconst menu = pluginMenus[i]\n\t\t\t\tif (menu) {\n\t\t\t\t\t// 拷贝一份，移除 json 字段\n\t\t\t\t\tconst dbMenu = JSON.parse(JSON.stringify(menu))\n\t\t\t\t\tdelete dbMenu.json\n\t\t\t\t\tmenus.push(dbMenu)\n\t\t\t\t}\n\t\t\t})\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '提示',\n\t\t\t\tcontent: '您确认要添加已选中的菜单吗？',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (!res.confirm) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\tmask: true\n\t\t\t\t\t})\n\t\t\t\t\tconst checkAll = menus.length === pluginMenus.length\n\t\t\t\t\tuniCloud.database().collection('opendb-admin-menus').add(menus).then(res => {\n\t\t\t\t\t\t// this.init()\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\ttitle: '提示',\n\t\t\t\t\t\t\tcontent: '添加菜单成功！',\n\t\t\t\t\t\t\tshowCancel: false,\n\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\tthis.$refs.pluginMenusTable.clearSelection()\n\t\t\t\t\t\t\t\tif (checkAll) {\n\t\t\t\t\t\t\t\t\tthis.currentTab = 'menus'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.loadData()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}).catch(err => {\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\ttitle: '提示',\n\t\t\t\t\t\t\tcontent: err.message,\n\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t})\n\t\t\t\t\t}).finally(() => {\n\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n}\n</script>\n<style>\n/* #ifndef H5 */\npage {\n\tpadding-top: 85px;\n}\n\n/* #endif */\n.menu-disable {\n\tcolor: red;\n}\n\n.menu-badge {\n\tposition: absolute;\n\ttop: 0;\n\tright: 5px;\n}\n</style>\n","import mod from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./list.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1669710689751\n      var cssReload = require(\"E:/编译器/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}